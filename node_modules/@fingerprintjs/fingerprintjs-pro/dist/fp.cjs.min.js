/**
 * FingerprintJS Pro v3.8.2 - Copyright (c) FingerprintJS, Inc, 2023 (https://fingerprint.com)
 *
 * This software contains code from open-source projects:
 * MurmurHash3 by Karan Lyons (https://github.com/karanlyons/murmurHash3.js)
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib");function t(e,t){return function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(e,t)?e[t]:void 0}function r(e){for(var t="",r=0;r<e.length;++r)if(r>0){var n=e[r].toLowerCase();n!==e[r]?t+=" ".concat(n):t+=e[r]}else t+=e[r].toUpperCase();return t}var n={default:"endpoint"},R={default:"tlsEndpoint"},o="Client timeout",i="Network connection error",E="Network request aborted",_="Response cannot be parsed",u="Blocked by CSP",a=r("WrongRegion"),s=r("SubscriptionNotActive"),O=r("UnsupportedVersion"),c=r("InstallationMethodRestricted"),p=r("HostnameRestricted"),I=r("IntegrationFailed"),d="API key required",l="API key not found",f="API key expired",N="Request cannot be parsed",T="Request failed",v="Request failed to process",A="Too many requests, rate limit exceeded",h="Not available for this origin",P="Not available with restricted header",S=d,D=l,x=f,m="3.8.2",w="9319";function L(t,r){var n=[];return function(t,r){var n=5,R=(s=t,O=e.__spreadArray([],s,!0),{current:function(){return O[0]},postpone:function(){var e=O.shift();void 0!==e&&O.push(e)},exclude:function(){O.shift()}}),o=(E=100,_=3e3,a=0,function(){return Math.random()*Math.min(_,E*Math.pow(2,a++))}),i=R.current();var E,_,a;var s,O;if(void 0===i)return Promise.reject(new TypeError("The list of script URL patterns is empty"));var c=function(e,t){return r(e).catch((function(e){if(t+1>=n)throw e;!function(e){if(!(e instanceof Error))return!1;var t=e.message;return t===u||t===w}(e)?R.postpone():R.exclude();var r,i=R.current();if(void 0===i)throw e;return(r=o(),new Promise((function(e){return setTimeout(e,r)}))).then((function(){return c(i,t+1)}))}))};return c(i,0)}(t,(function(e){var t=new Date,R=function(){return n.push({url:e,startedAt:t,finishedAt:new Date})},o=r(e);return o.then(R,R),o})).then((function(e){return[e,{attempts:n}]}))}var U="https://fpnpmcdn.net/v<version>/<apiKey>/loader_v<loaderVersion>.js",C=U,y="Failed to load the JS script of the agent";function K(r){var n;r.scriptUrlPattern;var R=r.token,o=r.apiKey,i=void 0===o?R:o,E=e.__rest(r,["scriptUrlPattern","token","apiKey"]),_=null!==(n=t(r,"scriptUrlPattern"))&&void 0!==n?n:U;return Promise.resolve().then((function(){if(!i||"string"!=typeof i)throw new Error(d);var e=function(e,t){return(Array.isArray(e)?e:[e]).map((function(e){return function(e,t){var r=encodeURIComponent;return e.replace(/<[^<>]+>/g,(function(e){return"<version>"===e?"3":"<apiKey>"===e?r(t):"<loaderVersion>"===e?r(m):e}))}(String(e),t)}))}(_,i);return L(e,M).catch(B)})).then((function(t){var r=t[0],n=t[1];return r.load(e.__assign(e.__assign({},E),{ldi:n}))}))}function M(e){return function(e,t,r,n){var R,o=document,i="securitypolicyviolation",E=function(t){var r=new URL(e,location.href),n=t.blockedURI;n!==r.href&&n!==r.protocol.slice(0,-1)&&n!==r.origin||(R=t,_())};o.addEventListener(i,E);var _=function(){return o.removeEventListener(i,E)};return null==n||n.then(_,_),Promise.resolve().then(t).then((function(e){return _(),e}),(function(e){return new Promise((function(e){return setTimeout(e)})).then((function(){if(_(),R)return r(R);throw e}))}))}(e,(function(){return function(e){return new Promise((function(t,r){var n=document.createElement("script"),R=function(){var e;return null===(e=n.parentNode)||void 0===e?void 0:e.removeChild(n)},o=document.head||document.getElementsByTagName("head")[0];n.onload=function(){R(),t()},n.onerror=function(){R(),r(new Error(y))},n.async=!0,n.src=e,o.appendChild(n)}))}(e)}),(function(){throw new Error(u)})).then(g)}function g(){var e=window,t="__fpjs_p_l_b",r=e[t];if(function(e,t){var r,n=null===(r=Object.getOwnPropertyDescriptor)||void 0===r?void 0:r.call(Object,e,t);(null==n?void 0:n.configurable)?delete e[t]:n&&!n.writable||(e[t]=void 0)}(e,t),"function"!=typeof(null==r?void 0:r.load))throw new Error(w);return r}function B(e){throw e instanceof Error&&e.message===w?new Error(y):e}var F={load:K,defaultScriptUrlPattern:C,ERROR_SCRIPT_LOAD_FAIL:y,ERROR_API_KEY_EXPIRED:f,ERROR_API_KEY_INVALID:l,ERROR_API_KEY_MISSING:d,ERROR_BAD_REQUEST_FORMAT:N,ERROR_BAD_RESPONSE_FORMAT:_,ERROR_CLIENT_TIMEOUT:o,ERROR_CSP_BLOCK:u,ERROR_FORBIDDEN_ENDPOINT:p,ERROR_FORBIDDEN_HEADER:P,ERROR_FORBIDDEN_ORIGIN:h,ERROR_GENERAL_SERVER_FAILURE:T,ERROR_INSTALLATION_METHOD_RESTRICTED:c,ERROR_INTEGRATION_FAILURE:I,ERROR_NETWORK_ABORT:E,ERROR_NETWORK_CONNECTION:i,ERROR_RATE_LIMIT:A,ERROR_SERVER_TIMEOUT:v,ERROR_SUBSCRIPTION_NOT_ACTIVE:s,ERROR_TOKEN_EXPIRED:x,ERROR_TOKEN_INVALID:D,ERROR_TOKEN_MISSING:S,ERROR_UNSUPPORTED_VERSION:O,ERROR_WRONG_REGION:a,defaultEndpoint:n,defaultTlsEndpoint:R};exports.ERROR_API_KEY_EXPIRED=f,exports.ERROR_API_KEY_INVALID=l,exports.ERROR_API_KEY_MISSING=d,exports.ERROR_BAD_REQUEST_FORMAT=N,exports.ERROR_BAD_RESPONSE_FORMAT=_,exports.ERROR_CLIENT_TIMEOUT=o,exports.ERROR_CSP_BLOCK=u,exports.ERROR_FORBIDDEN_ENDPOINT=p,exports.ERROR_FORBIDDEN_HEADER=P,exports.ERROR_FORBIDDEN_ORIGIN=h,exports.ERROR_GENERAL_SERVER_FAILURE=T,exports.ERROR_INSTALLATION_METHOD_RESTRICTED=c,exports.ERROR_INTEGRATION_FAILURE=I,exports.ERROR_NETWORK_ABORT=E,exports.ERROR_NETWORK_CONNECTION=i,exports.ERROR_RATE_LIMIT=A,exports.ERROR_SCRIPT_LOAD_FAIL=y,exports.ERROR_SERVER_TIMEOUT=v,exports.ERROR_SUBSCRIPTION_NOT_ACTIVE=s,exports.ERROR_TOKEN_EXPIRED=x,exports.ERROR_TOKEN_INVALID=D,exports.ERROR_TOKEN_MISSING=S,exports.ERROR_UNSUPPORTED_VERSION=O,exports.ERROR_WRONG_REGION=a,exports.default=F,exports.defaultEndpoint=n,exports.defaultScriptUrlPattern=C,exports.defaultTlsEndpoint=R,exports.load=K;
